<!doctype html>
<html>
  <head>
    <title>Git Commits Test</title>
  </head>
  <body>
    <h1>Git Commits API Test</h1>
    <div id="results"></div>
    <button onclick="testGitStatus()">Test Git Status</button>
    <button onclick="testGitCommits()">Test Git Commits</button>

    <script src="production/js/auth.js"></script>
    <script>
      async function testGitStatus() {
        try {
          if (!window.authManager) {
            document.getElementById("results").innerHTML = "AuthManager not ready";
            return;
          }

          const response = await window.authManager.apiRequest("/api/git/status");
          console.log("Git Status Response:", response);

          document.getElementById("results").innerHTML =
            "<h2>Git Status Response:</h2><pre>" + JSON.stringify(response, null, 2) + "</pre>";

          if (response.commits) {
            document.getElementById("results").innerHTML +=
              "<h3>Commits found: " + response.commits.length + "</h3>";
          }
        } catch (error) {
          console.error("Git Status Error:", error);
          document.getElementById("results").innerHTML = "Error: " + error.message;
        }
      }

      async function testGitCommits() {
        try {
          if (!window.authManager) {
            document.getElementById("results").innerHTML = "AuthManager not ready";
            return;
          }

          const response = await window.authManager.apiRequest("/api/git/commits/main");
          console.log("Git Commits Response:", response);

          document.getElementById("results").innerHTML =
            "<h2>Git Commits Response:</h2><pre>" + JSON.stringify(response, null, 2) + "</pre>";

          if (Array.isArray(response)) {
            document.getElementById("results").innerHTML +=
              "<h3>Commits found: " + response.length + "</h3>";
          }
        } catch (error) {
          console.error("Git Commits Error:", error);
          document.getElementById("results").innerHTML = "Error: " + error.message;
        }
      }

      // Wait for authManager to be ready
      document.addEventListener("DOMContentLoaded", function () {
        window.authManager = new AuthManager();
      });
    </script>
  </body>
</html>
