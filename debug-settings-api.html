<!doctype html>
<html>
  <head>
    <title>Debug Settings API</title>
  </head>
  <body>
    <h1>Debug Settings API Response</h1>
    <div id="results"></div>

    <script src="production/js/auth.js"></script>
    <script>
      async function testAPI() {
        try {
          // Wait for AuthManager to be ready
          if (!window.authManager) {
            console.log("Waiting for AuthManager...");
            setTimeout(testAPI, 100);
            return;
          }

          const resultsDiv = document.getElementById("results");

          // Test Git settings API
          console.log("Fetching Git settings...");
          const gitResponse = await window.authManager.apiRequest("/api/settings/git");
          console.log("Git API Response:", gitResponse);

          resultsDiv.innerHTML += "<h2>Git Settings API Response:</h2>";
          resultsDiv.innerHTML += "<pre>" + JSON.stringify(gitResponse, null, 2) + "</pre>";

          // Test specific value
          const sslValue = gitResponse.data?.verify_ssl;
          console.log("Git SSL Verification value:", sslValue, "Type:", typeof sslValue);
          resultsDiv.innerHTML +=
            "<p><strong>Git SSL Verification:</strong> " +
            sslValue +
            " (type: " +
            typeof sslValue +
            ")</p>";

          // Test Nautobot settings API
          console.log("Fetching Nautobot settings...");
          const nautobotResponse = await window.authManager.apiRequest("/api/settings/nautobot");
          console.log("Nautobot API Response:", nautobotResponse);

          resultsDiv.innerHTML += "<h2>Nautobot Settings API Response:</h2>";
          resultsDiv.innerHTML += "<pre>" + JSON.stringify(nautobotResponse, null, 2) + "</pre>";

          // Test specific value
          const nautobotSSLValue = nautobotResponse.data?.verify_ssl;
          console.log(
            "Nautobot SSL Verification value:",
            nautobotSSLValue,
            "Type:",
            typeof nautobotSSLValue
          );
          resultsDiv.innerHTML +=
            "<p><strong>Nautobot SSL Verification:</strong> " +
            nautobotSSLValue +
            " (type: " +
            typeof nautobotSSLValue +
            ")</p>";
        } catch (error) {
          console.error("API Test Error:", error);
          document.getElementById("results").innerHTML +=
            '<p style="color: red;">Error: ' + error.message + "</p>";
        }
      }

      // Start the test when page loads
      document.addEventListener("DOMContentLoaded", testAPI);
    </script>
  </body>
</html>
